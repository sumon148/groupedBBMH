% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DunnSmyth PPC R Functions.R
\name{DunnSmythTestBB}
\alias{DunnSmythTestBB}
\title{Dunn-Smyth Residual Diagnostics for Beta-Binomial Models}
\usage{
DunnSmythTestBB(
  ObservedResponse,
  size,
  group_size,
  alpha,
  beta,
  approximate.model = TRUE
)
}
\arguments{
\item{ObservedResponse}{A numeric vector of observed counts (length \eqn{D}).}

\item{size}{Integer. The number of trials in the binomial distribution (e.g., pool size).}

\item{group_size}{Integer. The size of the pooling group (used to adjust \code{beta}).}

\item{alpha}{A scalar or vector of \eqn{\alpha} values. If scalar, assumed fixed; if vector, assumed posterior samples.}

\item{beta}{A scalar or vector of \eqn{\beta} values. Same behavior as \code{alpha}.}

\item{approximate.model}{Logical. If \code{TRUE} (default), uses an approximate model where
\eqn{\Phi_i \sim \text{Beta}(\alpha, \beta / \text{group\_size})}. If \code{FALSE}, simulates the pooled response using adjusted probabilities.}
}
\value{
A named list containing:
\describe{
  \item{\code{DS}}{Dunn-Smyth residuals on \[0,1\] scale.}
  \item{\code{normalized_DS}}{Dunn-Smyth residuals transformed via \code{qnorm()}.}
  \item{\code{KS}}{The result of a Kolmogorov-Smirnov test comparing residuals to Uniform(0,1).}
  \item{\code{DS_hist}}{A ggplot2 histogram of the residuals.}
  \item{\code{DS_QQ_norm}}{A normal Q-Q plot of the transformed residuals, stratified by observed counts.}
}
}
\description{
Computes Dunn-Smyth randomized quantile residuals for beta-binomial models,
including approximate and simulation-based versions depending on whether
posterior samples for \code{alpha} and \code{beta} are vectors or scalars.
Useful for diagnosing model fit in pooled testing or overdispersed count models.
}
\examples{
\dontrun{
  set.seed(123)
  obs <- rbinom(100, size = 10, prob = 0.3)
  result <- DunnSmythTestBB(obs, size = 10, group_size = 5, alpha = 2, beta = 5)
  print(result$DS_QQ_norm)
  print(result$DS_hist)
}
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MH Algorithm Functions.R
\name{estimate_leakage}
\alias{estimate_leakage}
\title{Estimate Expected Leakage and Probability of Leakage}
\usage{
estimate_leakage(alpha, beta, B, b, M, m, sensitivity, cutoff = NULL)
}
\arguments{
\item{alpha}{Numeric vector or list of posterior chains for alpha (Beta distribution shape1).}

\item{beta}{Numeric vector or list of posterior chains for beta (Beta distribution shape2).}

\item{B}{Numeric scalar. Upper bound on leakage parameter.}

\item{b}{Numeric scalar. Lower bound on leakage parameter.}

\item{M}{Numeric scalar. Total number of items/entities.}

\item{m}{Numeric scalar. Number of items/entities considered in partial leakage.}

\item{sensitivity}{Numeric scalar, vector, or list of sensitivities. If list, treated as posterior samples. If sensitivity=1, exact formula will be used for probability of leakage.}

\item{cutoff}{Numeric scalar in [0, 1) or NULL. If specified, truncates calculations to [cutoff, 1] interval.}
}
\value{
A list containing inputs and computed quantities:
\describe{
  \item{B}{Upper leakage bound (input).}
  \item{b}{Lower leakage bound (input).}
  \item{cutoff}{Cutoff threshold for truncation, or NULL.}
  \item{M}{Total number of items (input).}
  \item{m}{Number of items considered in partial leakage (input).}
  \item{alpha}{Input alpha parameter(s).}
  \item{beta}{Input beta parameter(s).}
  \item{mu}{Mean of Beta distribution(s), alpha / (alpha + beta).}
  \item{sensitivity}{Input sensitivity parameter(s).}
  \item{E.L}{Expected leakage estimate(s). If posterior samples, a nested list; otherwise numeric vector.}
  \item{P.L}{Probability of leakage estimate(s). If posterior samples, a nested list; otherwise numeric vector.}
}
}
\description{
Computes the expected leakage and probability of leakage under a Beta-Binomial model.
Supports vector/scalar inputs or posterior samples (lists of chains).
Optionally applies a truncation cutoff on the Beta distribution tail.
}
\details{
The function estimates leakage under a Beta-Binomial model by integrating
over truncated or full Beta distributions, depending on whether a cutoff is specified.
It supports posterior chains by accepting lists of alpha, beta, and sensitivity values.
The expected leakage is calculated as a
ratio of incomplete Beta integrals, weighted by group sizes.
Two formulations for probability of leakage are used depending
on whether `sensitivity` equals 1 (exact) or differs from 1 (approximation).
}
\examples{
# Scalar/vector input example
estimate_leakage(alpha = 0.005, beta = 4.5, B = 8000, b = 13, M = 40, m = 5, sensitivity = 0.8)

# Posterior sample input example (lists of numeric vectors)
alpha_chain <- list(c(0.004, 0.005, 0.006), c(0.0035, 0.0042, 0.0055))
beta_chain <- list(c(3, 5, 6), c(4, 3, 5))
sensitivity_chain <- list(c(0.75, 0.8, 0.85), c(0.80, 0.75, 0.75))
estimate_leakage(alpha_chain, beta_chain, B = 8000, b = 13, M = 40, m = 5, sensitivity_chain,cutoff=0.01)
estimate_leakage(alpha_chain, beta_chain, B = 8000, b = 13, M = 40, m = 5, sensitivity = 0.8,cutoff=0.01)

}

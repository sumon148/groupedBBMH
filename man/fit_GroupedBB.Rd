% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MLE Functions.R
\name{fit_GroupedBB}
\alias{fit_GroupedBB}
\title{Fit Grouped Beta-Binomial (GroupedBB) Model to Grouped Data}
\usage{
fit_GroupedBB(
  ty,
  freq,
  b,
  m,
  sensitivity = 1,
  specificity = 1,
  theta = Inf,
  R = 10000,
  control = list(reltol = 1e-12, fnscale = -1),
  hessian = FALSE,
  leakage = FALSE,
  M = NULL,
  B = NULL
)
}
\arguments{
\item{ty}{Numeric vector. The observed counts of "successes" in grouped data.}

\item{freq}{Numeric vector. Frequencies corresponding to each count in `ty`.}

\item{b}{Integer. Number of trials per group.}

\item{m}{Integer. Minimum group size or related parameter used in likelihood calculation.}

\item{sensitivity}{Numeric, default 1. Sensitivity parameter for misclassification or detection.}

\item{specificity}{Numeric, default 1. Specificity parameter for misclassification or detection.}

\item{theta}{Numeric, default `Inf`. Overdispersion or shape parameter.}

\item{R}{Integer, default 10000. Number of repetitions or simulations used in likelihood approximation.}

\item{control}{List. Control parameters passed to `optim()`.}

\item{hessian}{Logical, default FALSE. Whether to return the Hessian matrix from optimization.}

\item{leakage}{Logical, default FALSE. Whether to include leakage in the model. Requires `M` and `B` if TRUE.}

\item{M}{Integer, optional. Maximum group size or related parameter used in likelihood calculation. Required if `leakage = TRUE`.}

\item{B}{Integer, optional. Number of bootstrap or simulation iterations required if `leakage = TRUE`.}
}
\value{
A list containing estimated parameters `alpha`, `beta`, `mu` (mean parameter),
        sensitivity, specificity, log-likelihood value (`loglik`), and convergence status.
        If `hessian = TRUE`, also returns the Hessian matrix.
        If `leakage = TRUE`, includes leakage-related estimates `P.L` and `E.L`.
}
\description{
Fits a beta-binomial model to grouped count data using maximum likelihood estimation.
Estimates parameters alpha and beta unless provided, and supports leakage estimation
when `leakage = TRUE`.
}
\examples{
freq <- c(2815, 9, 10, 6, 1, 3, 2, 0, 1, 2, 1, 0, 0, 0)
ty <- 0:13

# Fit model without leakage
bb.m1 <- fit_GroupedBB(ty = ty, freq = freq, b = 13, m = 5, M = 40,
                       sensitivity = 1, specificity = 1)

# Fit model with leakage (requires B)
bb.m2 <- fit_GroupedBB(ty = ty, freq = freq, b = 13, m = 5, M = 40, B = 8000,
                       sensitivity = 1, specificity = 1, leakage = TRUE)

}

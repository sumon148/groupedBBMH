% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MLE Functions.R
\name{fit_trGroupedBB}
\alias{fit_trGroupedBB}
\title{Fit Truncated Grouped Beta-Binomial (trGroupedBB) Model to Grouped Data}
\usage{
fit_trGroupedBB(
  ty,
  freq,
  b,
  m,
  cutoff,
  G = 1000,
  M = NULL,
  B = NULL,
  sensitivity = 1,
  specificity = 1,
  theta = Inf,
  control = list(reltol = 1e-12, fnscale = -1),
  return_hessian = FALSE,
  leakage = FALSE
)
}
\arguments{
\item{ty}{Numeric vector. A numeric vector of grouped test outcomes (e.g., number of test positive groups).}

\item{freq}{Numeric vector. Frequencies corresponding to each count in `ty`.}

\item{b}{Integer. Number of groups tested per replicate (i.e., binomial trials).}

\item{m}{Integer. Number of individuals included in each pooled group test.}

\item{cutoff}{Numeric. Truncation cutoff value.}

\item{G}{Integer, default 1000. Number of quantiles for numerical integration.}

\item{M}{Integer, optional. Required if leakage = TRUE. Total number of individuals in the larger group.
The value of `m` can be equal to M if all the group members are used for testing.}

\item{B}{Integer, optional. Required if leakage = TRUE. Total number of groups in a replicate (e.g., batch).}

\item{sensitivity}{Numeric, default 1. Sensitivity parameter.}

\item{specificity}{Numeric, default 1. Specificity parameter.}

\item{theta}{Clustering parameter. Use `Inf` for considering random groups.}

\item{control}{List. Control parameters passed to optim.}

\item{return_hessian}{Logical, default FALSE. Return Hessian matrix if TRUE.}

\item{leakage}{Logical, default FALSE. If TRUE (requires `M` and `B`), compute leakage quantities such as probability (`P.L`) and expected leakage (`E.L`) assuming perfect specificity.}
}
\value{
A list containing estimated parameters `alpha`, `beta`, `mu` (mean parameter),
        sensitivity, specificity, log-likelihood value (`loglik`), and convergence status.
        If `hessian = TRUE`, also returns the Hessian matrix. If `leakage = TRUE`, includes
        leakage-related estimates `P.L` and `E.L`.
}
\description{
This function fits a truncated beta-binomial model to grouped count data using maximum likelihood estimation
for a given cutoff. It estimates parameters alpha and beta unless provided, and supports estimating leakage
when `leakage = TRUE`.
}
\examples{
freq <- c(2815, 9, 10, 6, 1, 3, 2, 0, 1, 2, 1, 0, 0, 0)
ty <- 0:13

# Fit truncated grouped beta-binomial model with cutoff = 0 (no truncation)
trbb.m1 <- fit_trGroupedBB(ty, freq, b = 13, m = 5, cutoff = 0)
print(trbb.m1)

# Fit truncated grouped beta-binomial model with cutoff = 0.01 and imperfect sensitivity
trbb.m2 <- fit_trGroupedBB(ty, freq, b = 13, m = 5, cutoff = 0.01,
                       sensitivity = 0.8, specificity = 1)
print(trbb.m2)
}

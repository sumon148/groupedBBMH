% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Posterior Predictive Check Functions.R
\name{post_pred_sn}
\alias{post_pred_sn}
\title{Posterior Predictive Simulation for Grouped Beta-Binomial Model with Imperfect Sensitivity}
\usage{
post_pred_sn(n, alpha, beta, D, m, sensitivity)
}
\arguments{
\item{n}{Integer. Number of group tests per batch.}

\item{alpha}{Numeric vector. Posterior samples of the alpha parameter (length equal to number of MCMC draws).}

\item{beta}{Numeric vector. Posterior samples of the beta parameter (same length as \code{alpha}).}

\item{D}{Integer. Number of batches (observed outcomes).}

\item{m}{Integer. Number of individuals per group (used for group-test).}

\item{sensitivity}{Scalar or Numeric vector. Posterior samples of test sensitivity (same length as \code{alpha}).}
}
\value{
A list containing:
\describe{
  \item{\code{p_rep}}{Matrix of simulated latent prevalences (dimensions: draws × D).}
  \item{\code{phi_i_matrix}}{Matrix of adjusted group-level detection probabilities
                             after accounting for pooling and sensitivity.}
  \item{\code{ty_rep}}{Matrix of simulated observed binomial counts (dimensions: draws × D).}
}
}
\description{
Simulates posterior predictive responses under a grouped beta-binomial model
with known test sensitivity applied to group-level prevalence estimates.
The model includes a transformation to account for pooling and imperfect test sensitivity.
}
\details{
For each MCMC draw, prevalence in each group is simulated from a Beta distribution,
transformed to account for pooling as \code{1 - (1 - p)^m}, and then scaled by
the test sensitivity. The observed count is simulated using a Binomial distribution
with this adjusted probability.
}
\examples{
\dontrun{
alpha_samples <- rnorm(1000, 2, 0.1)
beta_samples <- rnorm(1000, 4, 0.2)
sn_samples <- runif(1000, 0.75, 0.80)
result <- post.pred.sn(n = 13, alpha = alpha_samples, beta = beta_samples,
                       D = 40, m = 5, sensitivity = sn_samples)
}

}

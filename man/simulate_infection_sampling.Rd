% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Simulation Infection Sampling.R
\name{simulate_infection_sampling}
\alias{simulate_infection_sampling}
\title{Simulate Infection Sampling with (Truncated) Beta-binomial and Sensitivity Adjustments}
\usage{
simulate_infection_sampling(
  alpha,
  beta,
  cutoff,
  D,
  B,
  M,
  m,
  b,
  sensitivity_values
)
}
\arguments{
\item{alpha}{Numeric. Shape parameter \eqn{\alpha} of the beta distribution for prevalence.}

\item{beta}{Numeric. Shape parameter \eqn{\beta} of the beta distribution for prevalence.}

\item{cutoff}{Numeric (0 < cutoff â‰¤ 1). Upper bound for the truncated beta distribution.}

\item{D}{Integer. Number of batches (i.e., number of simulated production units).}

\item{B}{Integer. Number of groups per batch.}

\item{M}{Integer. Number of items in each group.}

\item{m}{Integer. Number of items sampled from each group (for testing).}

\item{b}{Integer. Number of groups sampled per batch.}

\item{sensitivity_values}{Numeric vector. A vector of sensitivity values (from 0 to 1)
representing the probability that an infected group will be correctly identified.}
}
\value{
A named list of results, one element per sensitivity value. Each element is itself
        a list containing:
\describe{
  \item{`sensitivity`}{The sensitivity value used in that run.}
  \item{`T_Xi`}{True total number of contaminated items per batch.}
  \item{`T_Yi`}{True number of contaminated groups per batch (binary presence).}
  \item{`t_Xi`}{Total sampled contaminated items (with perfect sensitivity).}
  \item{`t_Yi`}{Number of sampled contaminated groups (with perfect sensitivity).}
  \item{`t_Xi_adjusted`}{Sampled contaminated items after applying sensitivity.}
  \item{`t_Yi_adjusted`}{Sampled contaminated groups after applying sensitivity.}
  \item{`comparison_tx`}{Comparison of true vs. detected contamination (items).}
  \item{`comparison_ty`}{Comparison of true vs. detected contamination (groups).}
}
}
\description{
Simulates contamination prevalence in batches using a (truncated) beta distribution,
generates infected item counts per group, and models the effect of sample-based testing
under varying group sensitivities. Sampling within groups is done using hypergeometric draws,
reflecting real-world testing practices.
}
\details{
This function helps compare the true contamination status in the population
versus what is observed through imperfect testing of sampled groups.


The function simulates contamination as follows:
\enumerate{
  \item Draw a batch-level contamination prevalence from a (truncated) beta distribution.
  \item Simulate contaminated item counts in each group using a binomial distribution.
  \item Derive contaminated group status (0/1).
  \item Simulate sampling from groups using hypergeometric draws.
  \item Apply group-level sensitivity to reflect imperfect detection.
  \item Compare population vs. sample detection outcomes.
}

Sensitivity values allow modeling of test performance degradation. The comparisons
(comparison_tx and comparison_ty) help quantify misclassification rates in sample-based testing.
}
\examples{
\dontrun{
set.seed(123)
results <- simulate_infection_sampling(
  alpha = 0.005, beta = 4.5, cutoff = 0.01,
  D = 1000, B = 8000, M = 40, m = 5, b = 13,
  sensitivity_values = c(1, 0.8)
)

# Inspect results for 90\% sensitivity
str(results[["0.8"]])
}

}
\seealso{
[rtrbeta()] for truncated beta distribution, [rhyper()] for hypergeometric sampling.
}
